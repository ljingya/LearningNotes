## JVM

##### JVM内存模型

- 类加载器

   将class文件加载到jvm中

- 内存区域

  - 方法区

    存储类结构信息，常量池，静态常量，构造函数

  - 虚拟机栈

    java栈与线程关联，每创建一个线程就创建一个java栈，在java栈中又包过栈帧，栈帧中存储了局部变量表，操作栈，方法返回等

  - 本地方法栈

    如虚拟机栈，jvm调用native方法

  - 堆

    存储java实例或者对象的区域，

  - 程序计数器

    保存线程执行的内存地址。

- 执行引擎

  ​	负责执行class文件中的字节码指令

- 本地方法库

  调用C或者C++实现的本地方法及回调结果

##### GC的原理及回收策略

​	引用类型：

- 强引用

  只要请引用存在就不回回收，

- 软引用

  内存不足时，会回收这类对象

- 弱引用

  生存到下次GC，当GC发生时，无论内存是否足够，都会回收该对象

- 虚引用

  无法通过虚引用获取一个对象的引用，

  

判断引用是否存在：

引用计数法：在内存中又这个对象的引用就+1，不引用就-1，但是无法解决循环引用的计数问题

可达性分析法：GcRoots链的顶点从上到下搜索，当一个对象没有任何引用链与GCRoots连接时，就说明此对象不可用。

GcRoots的对象：

- 虚拟机栈中引用的对象
- 方法区中静态属性引用的对象
- 方法区中常量引用的对象
- Native方法引用的对象

回收算法

- 标记-清除

  从根集合进行扫描，对存活的对象进行标记，然后再扫描未被标记的对象进行回收，容易遭成内存碎片

- 标记-整理

  从根集合扫描，对存活对象进行标记，然后扫描未被标记的对象进行回收，然后将所有存活对象进行左移，并更新对象指针，适合对象存货率高的老年代

- 复制

  将内存分为大小相等的两块，每次只使用一块，当这块用完时，会将存活着的对象复制到另一块，然后把使用过的那一块进行清理。

- 分代收集法

  根据堆内存的不同区域采用不同的回收策略。





